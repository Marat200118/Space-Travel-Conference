---
import BaseLayout from '../../layouts/BaseLayout.astro';
import TalkDetailed from '../../components/TalkDetailed.astro';
import fetchApi from '../../lib/strapi';


export async function getStaticPaths() {
  
  const talks = await fetchApi({
    endpoint: "talks",
    wrappedByKey: "data",
    query: { populate: ["*", "image", "speaker", "speaker.image", "location", "speaker.talks"] }
  });

  const paths = talks.map((talk) => ({
    params: { id: talk.id.toString() },
    props: { talk }, 
  }));

  return paths;
}

const { talk } = Astro.props; 
//  const { id } = Astro.request.params;
// const otherTalks = talk.attributes.speaker.data.attributes.talks.data.filter(t => t.id !== id);
---

<BaseLayout>
  <TalkDetailed talk={talk} />
</BaseLayout>


